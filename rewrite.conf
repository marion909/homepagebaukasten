# NGINX Rewrite-Regeln für Baukasten CMS
# Kopiere das in: /www/server/panel/vhost/rewrite/baukasten.neuhauser.cloud.conf

# Statische Assets direkt ausliefern (CSS, JS, Bilder)
location ~* \.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
    try_files $uri =404;
}

# Admin-Bereich
location /admin/ {
    try_files $uri $uri/ /admin/index.php$is_args$args;
}

# Uploads
location /uploads/ {
    try_files $uri =404;
}

# Root-URL zur Startseite umleiten
rewrite ^/$ /public/index.php?page=home permanent;

# Clean URLs für andere Seiten
if (!-e $request_filename) {
    rewrite ^/([^/]+)/?$ /public/index.php?page=$1 last;
}

# Blog-Posts
if (!-e $request_filename) {
    rewrite ^/blog/([^/]+)/?$ /public/index.php?page=blog&post=$1 last;
}

# Blog-Kategorien
if (!-e $request_filename) {
    rewrite ^/blog/category/([^/]+)/?$ /public/index.php?page=blog&category=$1 last;
}

# Blog-Tags  
if (!-e $request_filename) {
    rewrite ^/blog/tag/([^/]+)/?$ /public/index.php?page=blog&tag=$1 last;
}
